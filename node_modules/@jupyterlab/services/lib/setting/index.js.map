{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../../services/src/setting/index.ts"],"names":[],"mappings":";AAAA,0CAA0C;AAC1C,2DAA2D;;AAE3D,mDAE+B;AAE/B,wDAE6B;AAG7B;;GAEG;AACH,IAAM,oBAAoB,GAAG,cAAc,CAAC;AAG5C;;GAEG;AACH;IAEE;;OAEG;IACH,wBAAY,OAAsC;QAAtC,wBAAA,EAAA,YAAsC;QAChD,IAAI,CAAC,cAAc,GAAG,OAAO,CAAC,cAAc;YAC1C,mCAAgB,CAAC,YAAY,EAAE,CAAC;IACpC,CAAC;IAOD;;;;;;;OAOG;IACH,8BAAK,GAAL,UAAM,EAAU;QACN,IAAA,oCAAc,CAAU;QACxB,IAAA,gCAAO,EAAE,gCAAO,CAAoB;QAC5C,IAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC;QAC/B,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAClC,IAAM,OAAO,GAAG,mCAAgB,CAAC,WAAW,CAAC,GAAG,EAAE,EAAG,EAAE,cAAc,CAAC,CAAC;QAEvE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,UAAA,QAAQ;YAC1B,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;gBAC5B,MAAM,IAAI,mCAAgB,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACrD,CAAC;YAED,MAAM,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;;;;;;;OASG;IACH,6BAAI,GAAJ,UAAK,EAAU,EAAE,GAAW;QAClB,IAAA,oCAAc,CAAU;QACxB,IAAA,gCAAO,EAAE,gCAAO,CAAoB;QAC5C,IAAM,IAAI,GAAG,OAAO,GAAG,OAAO,CAAC;QAC/B,IAAM,GAAG,GAAG,OAAO,CAAC,GAAG,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC;QAClC,IAAM,IAAI,GAAG;YACX,IAAI,EAAE,GAAG;YACT,MAAM,EAAE,KAAK;SACd,CAAC;QACF,IAAM,OAAO,GAAG,mCAAgB,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,EAAE,cAAc,CAAC,CAAC;QAExE,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,UAAA,QAAQ;YAC1B,EAAE,CAAC,CAAC,QAAQ,CAAC,MAAM,KAAK,GAAG,CAAC,CAAC,CAAC;gBAC5B,MAAM,IAAI,mCAAgB,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACrD,CAAC;YAED,MAAM,CAAC,SAAS,CAAC;QACnB,CAAC,CAAC,CAAC;IACL,CAAC;IACH,qBAAC;AAAD,CAAC,AApED,IAoEC;AAnEK,wCAAc;AAqGpB;;GAEG;AACH,IAAU,OAAO,CAQhB;AARD,WAAU,OAAO;IACf;;OAEG;IACH,aACa,IAAY,EAAE,EAAU;QACnC,MAAM,CAAC,kBAAM,CAAC,IAAI,CAAC,IAAI,EAAE,oBAAoB,EAAE,EAAE,CAAC,CAAC;IACrD,CAAC;IAFQ,WAAG,MAEX,CAAA;AACH,CAAC,EARS,OAAO,KAAP,OAAO,QAQhB","sourcesContent":["// Copyright (c) Jupyter Development Team.\n// Distributed under the terms of the Modified BSD License.\n\nimport {\n  ISettingRegistry, URLExt\n} from '@jupyterlab/coreutils';\n\nimport {\n  ServerConnection\n} from '../serverconnection';\n\n\n/**\n * The url for the lab settings service.\n */\nconst SERVICE_SETTINGS_URL = 'api/settings';\n\n\n/**\n * The settings API service manager.\n */\nexport\nclass SettingManager {\n  /**\n   * Create a new setting manager.\n   */\n  constructor(options: SettingManager.IOptions = { }) {\n    this.serverSettings = options.serverSettings ||\n      ServerConnection.makeSettings();\n  }\n\n  /**\n   * The server settings used to make API requests.\n   */\n  readonly serverSettings: ServerConnection.ISettings;\n\n  /**\n   * Fetch a plugin's settings.\n   *\n   * @param id - The plugin's ID.\n   *\n   * @returns A promise that resolves with the plugin settings or rejects\n   * with a `ServerConnection.IError`.\n   */\n  fetch(id: string): Promise<ISettingRegistry.IPlugin> {\n    const { serverSettings } = this;\n    const { baseUrl, pageUrl } = serverSettings;\n    const base = baseUrl + pageUrl;\n    const url = Private.url(base, id);\n    const promise = ServerConnection.makeRequest(url, { }, serverSettings);\n\n    return promise.then(response => {\n      if (response.status !== 200) {\n        throw new ServerConnection.ResponseError(response);\n      }\n\n      return response.json();\n    });\n  }\n\n  /**\n   * Save a plugin's settings.\n   *\n   * @param id - The plugin's ID.\n   *\n   * @param raw - The user setting values as a raw string of JSON with comments.\n   *\n   * @returns A promise that resolves when saving is complete or rejects with\n   * a `ServerConnection.IError`.\n   */\n  save(id: string, raw: string): Promise<void> {\n    const { serverSettings } = this;\n    const { baseUrl, pageUrl } = serverSettings;\n    const base = baseUrl + pageUrl;\n    const url = Private.url(base, id);\n    const init = {\n      body: raw,\n      method: 'PUT'\n    };\n    const promise = ServerConnection.makeRequest(url, init, serverSettings);\n\n    return promise.then(response => {\n      if (response.status !== 204) {\n        throw new ServerConnection.ResponseError(response);\n      }\n\n      return undefined;\n    });\n  }\n}\n\n\n/**\n * A namespace for `SettingManager` statics.\n */\nexport\nnamespace SettingManager {\n  /**\n   * The instantiation options for a setting manager.\n   */\n  export\n  interface IOptions {\n    /**\n     * The server settings used to make API requests.\n     */\n    serverSettings?: ServerConnection.ISettings;\n  }\n}\n\n\n/**\n * A namespace for setting API interfaces.\n */\nexport\nnamespace Setting {\n  /**\n   * The interface for the setting system manager.\n   */\n  export\n  interface IManager extends SettingManager { }\n}\n\n\n/**\n * A namespace for private data.\n */\nnamespace Private {\n  /**\n   * Get the url for a plugin's settings.\n   */\n  export\n  function url(base: string, id: string): string {\n    return URLExt.join(base, SERVICE_SETTINGS_URL, id);\n  }\n}\n"]}